package filter;

import java.io.IOException;
import java.text.ParseException;

import reader.RecordReader;
import record.Enter;
import record.Record;

public class OrderFilter implements RecordReader {
	public long					blacklist[]	= { 6044810931727286224L,
			6045196035675595500L, 6045196035675653354L, 6045196035675735348L,
			6045196035675766973L, 6045196035675783701L, 6045196035675784785L,
			6045196035675815347L, 6045196035675884053L, 6045196035675905866L,
			6045196035675949901L, 6045196035676081115L, 6045196035676418303L,
			6045196035676447923L, 6045196035676502650L, 6045196035676502726L,
			6045196035676502727L, 6045196035676502728L, 6045196035676502729L,
			6045196035676502730L, 6045196035676502761L, 6045196035676502762L,
			6045196035676502763L, 6045196035676502764L, 6045196035676502771L,
			6045196035676502810L, 6045196035676502815L, 6045196035676502816L,
			6045196035676532931L, 6045196035676540615L, 6045196035676542071L,
			6045196035676545692L, 6045196035676545693L, 6045196035676545694L,
			6045196035676545695L, 6045196035676545696L, 6045196035676545713L,
			6045196035676545714L, 6045196035676549985L, 6045196035676549995L,
			6045196035676549996L, 6045196035676549997L, 6045196035676549998L,
			6045196035676550000L, 6045196035676550002L, 6045196035676550011L,
			6045196035676550012L, 6045196035676550013L, 6045196035676550014L,
			6045196035676550021L, 6045196035676550022L, 6045196035676550023L,
			6045196035676550024L, 6045196035676550029L, 6045196035676550030L,
			6045196035676550031L, 6045196035676550032L, 6045196035676550036L,
			6045196035676550037L, 6045196035676550038L, 6045196035676550039L,
			6045196035676550045L, 6045196035676550046L, 6045196035676550050L,
			6045196035676550051L, 6045196035676550052L, 6045196035676550053L,
			6045196035676550060L, 6045196035676552567L, 6045196035676552569L,
			6045196035676552589L, 6045196035676552669L, 6045196035676552747L,
			6045196035676552785L, 6045196035676558522L, 6045196035676567789L,
			6045196035676567873L, 6045196035676568042L, 6045196035676568273L,
			6045196035676568300L, 6045196035676568445L, 6045196035676568456L,
			6045196035676568462L, 6045196035676568468L, 6045196035676568473L,
			6045196035676568477L, 6045196035676568576L, 6045196035676568578L,
			6045196035676568580L, 6045196035676568581L };
	private final RecordReader	rr;

	public OrderFilter(RecordReader rr) {
		this.rr = rr;
	}

	@Override
	public void close() throws IOException {
		rr.close();
	}

	@Override
	public Record get() throws ParseException, IOException {
		while (true) {
			Record r = rr.get();
			if (r == null) {
				return null;
			}
			if (r.getType() == Record.Type.ENTER) {
				for (final long l : blacklist) {
					if (l == ((Enter) r).id) {
						r = null;
						break;
					}
				}
			}
			if (r != null) {
				return r;
			}

		}
	}

}
